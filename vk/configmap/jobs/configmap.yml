kind: ConfigMap
apiVersion: v1
metadata:
  name: wf
  namespace: default
data:
  wf.sh: |
    #!/bin/bash
    echo $HOME
    # shifter --image=docker:gurjyan/ersap:v0.4 --entrypoint
    shifter --image=docker:gurjyan/ersap:v0.4 -- /bin/bash /ersap/run-pipeline-4.sh
---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node3
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {3221..3224}
    do
      j=$((i - 1000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="2776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint


---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node4
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {4221..4224}
    do
      j=$((i - 2000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="3776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint

---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node5
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {5221..5224}
    do
      j=$((i - 3000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="4776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint

---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node6
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {6221..6224}
    do
      j=$((i - 4000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="5776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint

---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node7
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {7221..7224}
    do
      j=$((i - 5000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="6776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint


---
kind: ConfigMap
apiVersion: v1
metadata:
  name: prom-node8
  namespace: default
data:
  prom.sh: |
    #!/bin/bash
    sleep 10
    
    for i in {8221..8224}
    do
      j=$((i - 6000))
      ssh -NfR $i:localhost:$j $PROM_SERVER
    done

    export PROCESS_EXPORTER_PORT="7776"
    ssh -NfR $PROCESS_EXPORTER_PORT:localhost:$PROCESS_EXPORTER_PORT $PROM_SERVER 
    shifter --image=jlabtsai/process-exporter:pgid-go -V /proc:/host_proc --entrypoint
